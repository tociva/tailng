<div [class]="rootKlass()">
  <!-- Trigger -->
  <button
    #triggerEl
    type="button"
    [class]="triggerKlass()"
    aria-haspopup="menu"
    [attr.aria-expanded]="isOpen()"
    (click)="onTriggerClick()"
  >
    <ng-content select="[tngMenuTrigger]"></ng-content>
  </button>

  <!-- Overlay -->
  <tng-overlay-ref
    [open]="isOpen()"
    (openChange)="onOverlayOpenChange($event)"
    (opened)="onOverlayOpened()"
    (closed)="onOverlayClosed($event)"
  >
    <tng-connected-overlay
      [open]="isOpen()"
      [anchor]="triggerEl"
      [placement]="placement()"
      [offset]="offset()"
      [width]="width()"
      [closeOnOutsideClick]="closeOnOutsideClick()"
      [closeOnEscape]="closeOnEscape()"
      (closed)="onOverlayClosed($event)"
    >
      <tng-overlay-panel [klass]="panelKlass()">
        <div role="menu" class="outline-none">
          <!-- âœ… Render the projected <ng-template> content -->
          <ng-container *ngIf="menuTpl; else contentSlot"
            [ngTemplateOutlet]="menuTpl"
          ></ng-container>

          <!-- Fallback: support <div tngMenuContent>...</div> -->
          <ng-template #contentSlot>
            <ng-content select="[tngMenuContent]"></ng-content>
          </ng-template>
        </div>
      </tng-overlay-panel>
    </tng-connected-overlay>
  </tng-overlay-ref>
</div>
