<div [class]="containerClassFinal()">
  <!-- Hidden native input -->
  <input
    #fileInput
    type="file"
    class="sr-only"
    [disabled]="isDisabled()"
    [accept]="accept()"
    [multiple]="multiple()"
    (change)="onNativeChange($event)"
    (blur)="onBlur()"
  />

  <!-- Dropzone -->
  <div
    tngFileDropzone
    [disabled]="isDisabled()"
    [accept]="accept()"
    [multiple]="multiple()"
    (filesDropped)="onDropped($event)"
    (dragActiveChange)="onDragActiveChange($event)"
    [class]="dropzoneClassFinal()"
    role="button"
    tabindex="0"
    (click)="openPicker()"
    (keydown.enter)="openPicker()"
    (keydown.space)="openPicker()"
  >
    <div [class]="headerClassFinal()">
      <div class="space-y-1">
        <div [class]="titleClassFinal()">{{ titleText() }}</div>
        <div [class]="subtitleClassFinal()">{{ subtitleText() }}</div>
      </div>

      @if (value()?.length) {
        <button
          type="button"
          [class]="clearButtonClassFinal()"
          (click)="$event.stopPropagation(); clear()"
        >
          Clear
        </button>
      }
    </div>

    @if (accept()) {
      <div class="mt-2" [class]="hintClassFinal()">
        Accepted: {{ accept() }}
      </div>
    }
  </div>

  <!-- File list -->
  @if (value()?.length) {
    <div [class]="fileListClassFinal()">
      @for (f of value()!; track trackByName($index, f)) {
        <div [class]="fileItemClassFinal()">
          <span [class]="fileNameClassFinal()">{{ f.name }}</span>
          <span [class]="fileSizeClassFinal()">
            {{ (f.size / 1024).toFixed(1) }} KB
          </span>
        </div>
      }
    </div>
  }
</div>
